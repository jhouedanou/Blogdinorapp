import{u as j,_ as N,H as O}from"./DeKLCFPw.js";import{c as n,o as s,r as $,h as d,g as S,f as z,v as V,u as W,a,j as U,b as _,p as Y,k as f,t as k,F as G,l as J,n as K,s as Q}from"./DkQMdCnK.js";import{_ as x}from"./DlAUqK2U.js";import"./CjTA47oG.js";const X={props:{pageUrl:{type:String,required:!0},pageIdentifier:{type:String,required:!0}},mounted(){this.loadDisqus()},methods:{loadDisqus(){(function(){var c=document,i=c.createElement("script");i.src="https://dinor-app.disqus.com/embed.js",i.setAttribute("data-timestamp",+new Date),(c.head||c.body).appendChild(i)})()}}},Z={id:"disqus_thread"};function ee(c,i,g,h,b,u){return s(),n("div",Z)}const te=x(X,[["render",ee],["__scopeId","data-v-c3ff57e9"]]);function y(c){return new URL(window.location.href)}const ae={class:"container"},re={class:"content-wrapper"},ne={class:"reading-progress-container"},se={key:0,class:"loading"},oe={key:1,class:"error"},le={key:2,class:"post-article"},ie={class:"post-header"},ce={class:"post-meta-info"},ue={class:"post-date"},de={key:0,class:"post-categories"},pe=["innerHTML"],ge={key:0,class:"post-image-container"},me={key:1,class:"post-no-image"},ve=["innerHTML"],fe={class:"btn-tooltip"},he={__name:"[slug]",setup(c){const i=z(),{posts:g,loading:h,fetchPostBySlug:b}=j(),u=$(!1),C=$(0),r=d(()=>g.value&&g.value.length>0?g.value[0]:null),I=()=>{const t=window.scrollY,e=document.documentElement.scrollHeight,o=window.innerHeight,l=t/(e-o);C.value=Math.min(l*100,100)},D=t=>{if(!t)return"";const e=new Date(t);return new Intl.DateTimeFormat("fr-FR",{day:"numeric",month:"long",year:"numeric"}).format(e)},L=(t,e)=>{if(!e||!e.categories)return"";const o=e.categories.find(l=>l.id===t||l.slug===t);return o?o.name:""};S(async()=>{const t=i.params.slug;t&&(console.log("Chargement de l'article avec le slug:",t),await b(t)),window.addEventListener("scroll",I)}),V(()=>{window.removeEventListener("scroll",I)});const T=async()=>{if(!u.value)try{u.value=!0;const t=i.params.slug;await b(t,!0),console.log("Cache rafraîchi et article rechargé avec succès")}catch(t){console.error("Erreur lors du rafraîchissement du cache:",t)}finally{u.value=!1}},R=()=>{Q("/")},P=t=>{if(!t)return"";let e=t.replace(/&eacute;/g,"é").replace(/&egrave;/g,"è").replace(/&agrave;/g,"à").replace(/&ccedil;/g,"ç").replace(/&ecirc;/g,"ê").replace(/&ocirc;/g,"ô").replace(/&ucirc;/g,"û").replace(/&icirc;/g,"î").replace(/&euml;/g,"ë").replace(/&iuml;/g,"ï").replace(/&uuml;/g,"ü").replace(/&acirc;/g,"â").replace(/&ugrave;/g,"ù").replace(/&Eacute;/g,"É").replace(/&Egrave;/g,"È").replace(/&Agrave;/g,"À").replace(/&Ccedil;/g,"Ç").replace(/&nbsp;/g," ");return e=e.replace(/<p>/g,'<p class="enhanced-paragraph">'),e},m=d(()=>{if(!r.value)return null;if(r.value.featuredImage){if(r.value.featuredImage.medium&&r.value.featuredImage.medium.url)return console.log("Utilisation de l'image moyenne du featured_image"),r.value.featuredImage.medium.url;if(r.value.featuredImage.large&&r.value.featuredImage.large.url)return console.log("Utilisation de l'image large du featured_image"),r.value.featuredImage.large.url;if(r.value.featuredImage.full)return console.log("Utilisation de l'image full du featured_image"),r.value.featuredImage.full}return r.value.thumbnail?(console.log("Utilisation de l'image thumbnail"),r.value.thumbnail):(console.log("Aucune image disponible pour cet article"),null)}),v=d(()=>{if(!r.value)return"";const t=r.value.content.replace(/<[^>]*>/g,"");return t.substring(0,160)+(t.length>160?"...":"")}),H=d(()=>r.value?`${r.value.title} ${r.value.content.replace(/<[^>]*>/g,"")}`.toLowerCase().split(/\W+/).filter(o=>o.length>3).filter((o,l,M)=>M.indexOf(o)===l).slice(0,10).join(", "):"");W(()=>{var t,e;return{title:r.value?`${r.value.title} | Dinor App`:"Chargement...",meta:[{name:"description",content:v.value},{name:"keywords",content:H.value},{property:"og:title",content:(t=r.value)==null?void 0:t.title},{property:"og:description",content:v.value},{property:"og:type",content:"article"},{property:"og:url",content:y().href},{property:"og:image",content:m.value||"/images/default-thumbnail.jpg"},{property:"og:site_name",content:"Dinor App"},{name:"twitter:card",content:"summary_large_image"},{name:"twitter:title",content:(e=r.value)==null?void 0:e.title},{name:"twitter:description",content:v.value},{name:"twitter:image",content:m.value||"/images/default-thumbnail.jpg"}]}});const p=d(()=>r.value?y().href:""),w=d(()=>{var t;return((t=r.value)==null?void 0:t.title)||"Blog Dinor"}),E=()=>{const t=`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(p.value)}`;window.open(t,"_blank","noopener,noreferrer")},q=()=>{const t=`https://twitter.com/intent/tweet?text=${encodeURIComponent(w.value)}&url=${encodeURIComponent(p.value)}`;window.open(t,"_blank","noopener,noreferrer")},A=()=>{const t=`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(p.value)}`;window.open(t,"_blank","noopener,noreferrer")},B=()=>{const t=`https://wa.me/?text=${encodeURIComponent(`${w.value} ${p.value}`)}`;window.open(t,"_blank","noopener,noreferrer")},F=async()=>{if(navigator.share)try{await navigator.share({title:w.value,text:v.value,url:p.value})}catch(t){t.name!=="AbortError"&&console.error("Error sharing:",t)}};return(t,e)=>{const o=N;return s(),n("div",ae,[e[13]||(e[13]=a("div",{class:"blog-background"},null,-1)),e[14]||(e[14]=a("div",{class:"blog-overlay"},null,-1)),a("div",re,[_(O),a("div",ne,[a("div",{class:"reading-progress-bar",style:Y({width:C.value+"%"})},null,4)]),e[10]||(e[10]=a("div",{class:"header-actions"},null,-1)),f(h)?(s(),n("div",se,e[0]||(e[0]=[a("div",{class:"spinner"},null,-1),a("p",null,"Chargement de l'article...",-1)]))):r.value?(s(),n("article",le,[a("header",ie,[a("div",ce,[a("div",ue,k(D(r.value.date)),1),r.value.categories&&r.value.categories.length?(s(),n("div",de,[(s(!0),n(G,null,J(r.value.categories,l=>(s(),n("span",{key:l,class:"category-badge"},k(L(l,r.value)),1))),128))])):U("",!0)]),a("h1",{class:"post-title",innerHTML:r.value.title},null,8,pe)]),m.value?(s(),n("div",ge,[_(o,{src:m.value,alt:r.value.title,width:"900",height:"500",placeholder:"",format:"webp",class:"post-featured-image"},null,8,["src","alt"])])):(s(),n("div",me,e[3]||(e[3]=[a("div",{class:"no-image-label"},"Pas d'image disponible",-1)]))),a("div",{class:"post-content",innerHTML:P(r.value.content)},null,8,ve),_(te,{pageUrl:f(y)().href,pageIdentifier:f(i).path},null,8,["pageUrl","pageIdentifier"]),a("div",{class:"share-container"},[e[9]||(e[9]=a("h3",{class:"share-title"},"Partager cet article",-1)),a("div",{class:"share-buttons"},[a("button",{onClick:F,class:"share-button native","aria-label":"Partager nativement"},e[4]||(e[4]=[a("span",{class:"share-icon"},"⇧",-1)])),a("button",{onClick:E,class:"share-button facebook","aria-label":"Partager sur Facebook"},e[5]||(e[5]=[a("span",{class:"share-icon"},"f",-1)])),a("button",{onClick:q,class:"share-button twitter","aria-label":"Partager sur Twitter"},e[6]||(e[6]=[a("span",{class:"share-icon"},"t",-1)])),a("button",{onClick:A,class:"share-button linkedin","aria-label":"Partager sur LinkedIn"},e[7]||(e[7]=[a("span",{class:"share-icon"},"in",-1)])),a("button",{onClick:B,class:"share-button whatsapp","aria-label":"Partager sur WhatsApp"},e[8]||(e[8]=[a("span",{class:"share-icon"},"w",-1)]))])])])):(s(),n("div",oe,[e[1]||(e[1]=a("h2",null,"Article non trouvé",-1)),e[2]||(e[2]=a("p",null,"L'article que vous recherchez n'existe pas ou a été supprimé.",-1)),a("button",{class:"back-button",onClick:R},"Retourner à la liste des articles")]))]),a("button",{class:"floating-btn back-floating-btn",onClick:R,"aria-label":"Retour à la liste des articles"},e[11]||(e[11]=[a("span",{class:"back-icon"},"←",-1),a("span",{class:"btn-tooltip"},"Retour",-1)])),f(h)?U("",!0):(s(),n("button",{key:0,onClick:T,class:K(["floating-btn refresh-floating-btn",{refreshing:u.value}]),"aria-label":"Rafraîchir l'article"},[e[12]||(e[12]=a("span",{class:"refresh-icon"},"↻",-1)),a("span",fe,k(u.value?"Rafraîchissement...":"Rafraîchir"),1)],2))])}}},ye=x(he,[["__scopeId","data-v-02182794"]]);export{ye as default};
