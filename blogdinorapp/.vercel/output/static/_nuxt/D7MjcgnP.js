import{u as O,H as Q,_ as W}from"./DeKLCFPw.js";import{_ as X}from"./CjTA47oG.js";import{r as L,e as Y,f as Z,g as ee,h as b,i as ae,c as o,a as s,j as g,b as C,k as l,t as c,w as D,T as te,n as _,d as h,F as T,l as B,m as se,o as r,p as le,q as re,s as oe}from"./DkQMdCnK.js";import{_ as ne}from"./DlAUqK2U.js";const ie={class:"container"},ce={class:"content-wrapper"},ue={class:"header-actions"},pe={key:0,class:"active-filter"},ge={class:"filter-value"},de={key:0,class:"loading"},ve={key:1},me=["onClick"],fe={class:"post-image-container"},be={key:1,class:"no-image"},_e=["innerHTML"],he={class:"post-meta"},ye={class:"post-date"},ke={key:0,class:"post-categories"},xe=["innerHTML"],Ce={class:"post-footer"},Te={key:0,class:"no-posts"},Be={key:0},Pe={key:1,class:"pagination"},we=["disabled"],Me={class:"pagination-pages"},Re=["onClick","disabled"],Ve=["disabled"],qe={key:2,class:"posts-info"},Ae={key:0},Ee={class:"btn-tooltip"},Fe={__name:"index",setup(He){const P=Z(),w=se(),{posts:u,loading:y,fetchPosts:N,refreshCache:$,currentPage:p,totalPages:i,goToPage:z,nextPage:M,prevPage:R,itemsPerPage:m,activeCategory:d,setActiveCategory:V,clearCategoryFilter:q}=O(),f=L(!1);L(!1),Y(()=>{const{category:a}=P.query;a&&V(a)}),ee(async()=>{await N(),u.value&&u.value.length>0&&(console.log("Premier article:",u.value[0]),console.log("Type du titre:",typeof u.value[0].title),console.log("Titre brut:",u.value[0].title))});const I=async()=>{if(!f.value)try{f.value=!0,await $(),console.log("Cache rafraîchi avec succès")}catch(a){console.error("Erreur lors du rafraîchissement du cache:",a)}finally{f.value=!1}},S=a=>{oe(`/post/${a}`)},j=a=>{if(!a)return"";const e=new Date(a);return new Intl.DateTimeFormat("fr-FR",{day:"numeric",month:"long",year:"numeric"}).format(e)},A=()=>{q(),w.replace("/")},k=a=>{switch(a){case"recette":return"Recettes";case"top-10":return"Top 10";default:return a.charAt(0).toUpperCase()+a.slice(1).replace(/-/g," ")}},G=a=>{if(!a)return"";let e=a.replace(/&eacute;/g,"é").replace(/&egrave;/g,"è").replace(/&agrave;/g,"à").replace(/&ccedil;/g,"ç").replace(/&ecirc;/g,"ê").replace(/&ocirc;/g,"ô").replace(/&ucirc;/g,"û").replace(/&icirc;/g,"î").replace(/&euml;/g,"ë").replace(/&iuml;/g,"ï").replace(/&uuml;/g,"ü").replace(/&acirc;/g,"â").replace(/&ugrave;/g,"ù").replace(/&Eacute;/g,"É").replace(/&Egrave;/g,"È").replace(/&Agrave;/g,"À").replace(/&Ccedil;/g,"Ç").replace(/&nbsp;/g," ");return e=e.replace(/<p>/g,"").replace(/<\/p>/g,"").replace(/\[&hellip;\]/g,"...").replace(/\[…\]/g,"...").replace(/\.\.\.<\/p>/g,"...").replace(/\s+/g," ").trim(),e.length>150&&(e=e.substring(0,150)+"..."),e},U=a=>a?a.replace(/&rsquo;/g,"'").replace(/&lsquo;/g,"'").replace(/&rdquo;/g,'"').replace(/&ldquo;/g,'"').replace(/&eacute;/g,"é").replace(/&egrave;/g,"è").replace(/&agrave;/g,"à").replace(/&ccedil;/g,"ç").replace(/&ecirc;/g,"ê").replace(/&ocirc;/g,"ô").replace(/&ucirc;/g,"û").replace(/&icirc;/g,"î").replace(/&euml;/g,"ë").replace(/&iuml;/g,"ï").replace(/&uuml;/g,"ü").replace(/&acirc;/g,"â").replace(/&ugrave;/g,"ù").replace(/&Eacute;/g,"É").replace(/&Egrave;/g,"È").replace(/&Agrave;/g,"À").replace(/&Ccedil;/g,"Ç").replace(/&nbsp;/g," "):"",E=b(()=>i.value*m.value),F=b(()=>{const a=(p.value-1)*m.value+1,e=Math.min(p.value*m.value,E.value);return{start:a,end:e}}),J=b(()=>{const e=[];if(i.value<=5)for(let n=1;n<=i.value;n++)e.push({value:n,label:n,type:"page"});else{e.push({value:1,label:1,type:"page"});let n=Math.max(2,p.value-Math.floor(5/2)+1),v=Math.min(i.value-1,n+5-3);v-n<2&&(n=Math.max(2,v-2+1)),n>2&&e.push({value:null,label:"...",type:"ellipsis"});for(let t=n;t<=v;t++)e.push({value:t,label:t,type:"page"});v<i.value-1&&e.push({value:null,label:"...",type:"ellipsis"}),e.push({value:i.value,label:i.value,type:"page"})}return e});b(()=>{const a=(p.value-1)*m.value,e=a+m.value;return u.value.slice(a,e)}),ae(()=>P.query.category,a=>{a?V(a):q()});const K=()=>{w.go(-1)};return(a,e)=>{const n=W,v=X;return r(),o("div",ie,[e[10]||(e[10]=s("div",{class:"blog-background"},null,-1)),e[11]||(e[11]=s("div",{class:"blog-overlay"},null,-1)),s("div",ce,[s("div",null,[C(Q),s("div",ue,[l(d)?(r(),o("div",pe,[e[2]||(e[2]=s("span",{class:"filter-label"},"Filtré par : ",-1)),s("span",ge,c(k(l(d))),1),s("button",{onClick:A,class:"clear-filter-btn"},"×")])):g("",!0)]),l(y)?(r(),o("div",de,e[3]||(e[3]=[s("div",{class:"spinner"},null,-1),s("p",null,"Chargement des articles...",-1)]))):(r(),o("div",ve,[C(te,{name:"post-list",tag:"div",class:"posts-grid"},{default:D(()=>[(r(!0),o(T,null,B(l(u),(t,H)=>(r(),o("div",{key:t.id,class:"post-card",onClick:x=>S(t.slug),style:le({"--i":H})},[s("div",fe,[t.thumbnail?(r(),re(n,{key:0,src:t.thumbnail,width:"340",height:"180",quality:"90",format:"webp",alt:t.title,class:"post-thumbnail-image"},null,8,["src","alt"])):(r(),o("div",be,"Pas d'image")),s("h3",{class:"post-title-overlay",innerHTML:U(t.title)},null,8,_e)]),s("div",he,[s("span",ye,c(j(t.date)),1),t.categories&&t.categories.length?(r(),o("div",ke,[(r(!0),o(T,null,B(t.categories,x=>(r(),o("span",{key:x.id,class:"category-badge"},c(x.name),1))),128))])):g("",!0)]),s("div",{class:"post-excerpt",innerHTML:G(t.excerpt)},null,8,xe),s("div",Ce,[C(v,{to:`/post/${t.slug}`,class:"read-more-btn"},{default:D(()=>e[4]||(e[4]=[h("Lire plus")])),_:2},1032,["to"])])],12,me))),128))]),_:1}),l(u).length===0?(r(),o("div",Te,[e[5]||(e[5]=s("h3",null,"Aucun article trouvé",-1)),l(d)?(r(),o("p",Be,`Aucun article n'a été trouvé dans la catégorie "`+c(k(l(d)))+'".',1)):g("",!0),s("button",{onClick:A,class:"refresh-btn"},"Voir tous les articles")])):g("",!0),l(i)>1?(r(),o("div",Pe,[s("button",{onClick:e[0]||(e[0]=(...t)=>l(R)&&l(R)(...t)),class:_(["pagination-btn",{disabled:l(p)===1}]),disabled:l(p)===1},e[6]||(e[6]=[s("span",{class:"pagination-arrow"},"←",-1),h(" Précédent ")]),10,we),s("div",Me,[(r(!0),o(T,null,B(J.value,t=>(r(),o("button",{key:t.value,onClick:H=>l(z)(t.value),class:_(["pagination-page",{active:t.value===l(p),ellipsis:t.type==="ellipsis"}]),disabled:t.type==="ellipsis"},c(t.label),11,Re))),128))]),s("button",{onClick:e[1]||(e[1]=(...t)=>l(M)&&l(M)(...t)),class:_(["pagination-btn",{disabled:l(p)===l(i)}]),disabled:l(p)===l(i)},e[7]||(e[7]=[h(" Suivant "),s("span",{class:"pagination-arrow"},"→",-1)]),10,Ve)])):g("",!0),l(u).length>0?(r(),o("div",qe,[h(" Affichage de "+c(F.value.start)+"-"+c(F.value.end)+" sur "+c(E.value)+" articles ",1),l(d)?(r(),o("span",Ae,' dans la catégorie "'+c(k(l(d)))+'"',1)):g("",!0)])):g("",!0)]))]),l(y)?g("",!0):(r(),o("button",{key:0,onClick:I,class:_(["floating-btn refresh-floating-btn",{refreshing:f.value}]),"aria-label":"Rafraîchir les articles"},[e[8]||(e[8]=s("span",{class:"refresh-icon"},"↻",-1)),s("span",Ee,c(f.value?"Rafraîchissement...":"Rafraîchir"),1)],2)),l(y)?g("",!0):(r(),o("button",{key:1,onClick:K,class:"floating-btn back-floating-btn","aria-label":"Retour"},e[9]||(e[9]=[s("span",{class:"back-icon"},"⇐",-1),s("span",{class:"btn-tooltip"},"Retour",-1)])))])])}}},ze=ne(Fe,[["__scopeId","data-v-c3a9d64d"]]);export{ze as default};
