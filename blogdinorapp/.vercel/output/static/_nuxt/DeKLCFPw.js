import{x as V,y as re,z as B,A as R,B as se,C as O,D as ie,E as G,G as Q,h as x,H as oe,I as ne,r as b,g as ae,c as X,J as le,o as Y,K as F,k as j,L as ce,i as ue,m as de,a as M,b as E,w as T,d as k,M as H}from"./DkQMdCnK.js";import{_ as ge}from"./CjTA47oG.js";import{_ as fe}from"./DlAUqK2U.js";async function he(e,t){return await me(t).catch(r=>(console.error("Failed to get image meta for "+t,r+""),{width:0,height:0,ratio:0}))}async function me(e){if(typeof Image>"u")throw new TypeError("Image not supported");return new Promise((t,s)=>{const r=new Image;r.onload=()=>{const i={width:r.width,height:r.height,ratio:r.width/r.height};t(i)},r.onerror=i=>s(i),r.src=e})}function L(e){return t=>t?e[t]||t:e.missingValue}function ve({formatter:e,keyMap:t,joinWith:s="/",valueMap:r}={}){e||(e=(a,n)=>`${a}=${n}`),t&&typeof t!="function"&&(t=L(t));const i=r||{};return Object.keys(i).forEach(a=>{typeof i[a]!="function"&&(i[a]=L(i[a]))}),(a={})=>Object.entries(a).filter(([o,d])=>typeof d<"u").map(([o,d])=>{const u=i[o];return typeof u=="function"&&(d=u(a[o])),o=typeof t=="function"?t(o):o,e(o,d)}).join(s)}function S(e=""){if(typeof e=="number")return e;if(typeof e=="string"&&e.replace("px","").match(/^\d+$/g))return Number.parseInt(e,10)}function pe(e=""){if(e===void 0||!e.length)return[];const t=new Set;for(const s of e.split(" ")){const r=Number.parseInt(s.replace("x",""));r&&t.add(r)}return Array.from(t)}function ye(e){if(e.length===0)throw new Error("`densities` must not be empty, configure to `1` to render regular size only (DPR 1.0)")}function we(e){const t={};if(typeof e=="string")for(const s of e.split(/[\s,]+/).filter(r=>r)){const r=s.split(":");r.length!==2?t["1px"]=r[0].trim():t[r[0].trim()]=r[1].trim()}else Object.assign(t,e);return t}function _e(e){const t={options:e},s=(i,a={})=>Z(t,i,a),r=(i,a={},n={})=>s(i,{...n,modifiers:V(a,n.modifiers||{})}).url;for(const i in e.presets)r[i]=(a,n,o)=>r(a,n,{...e.presets[i],...o});return r.options=e,r.getImage=s,r.getMeta=(i,a)=>Se(t,i,a),r.getSizes=(i,a)=>$e(t,i,a),t.$img=r,r}async function Se(e,t,s){const r=Z(e,t,{...s});return typeof r.getMeta=="function"?await r.getMeta():await he(e,r.url)}function Z(e,t,s){var u,m;if(t&&typeof t!="string")throw new TypeError(`input must be a string (received ${typeof t}: ${JSON.stringify(t)})`);if(!t||t.startsWith("data:"))return{url:t};const{provider:r,defaults:i}=be(e,s.provider||e.options.provider),a=xe(e,s.preset);if(t=B(t)?t:re(t),!r.supportsAlias){for(const g in e.options.alias)if(t.startsWith(g)){const v=e.options.alias[g];v&&(t=R(v,t.slice(g.length)))}}if(r.validateDomains&&B(t)){const g=se(t).host;if(!e.options.domains.find(v=>v===g))return{url:t}}const n=V(s,a,i);n.modifiers={...n.modifiers};const o=n.modifiers.format;(u=n.modifiers)!=null&&u.width&&(n.modifiers.width=S(n.modifiers.width)),(m=n.modifiers)!=null&&m.height&&(n.modifiers.height=S(n.modifiers.height));const d=r.getImage(t,n,e);return d.format=d.format||o||"",d}function be(e,t){const s=e.options.providers[t];if(!s)throw new Error("Unknown provider: "+t);return s}function xe(e,t){if(!t)return{};if(!e.options.presets[t])throw new Error("Unknown preset: "+t);return e.options.presets[t]}function $e(e,t,s){var $,P,q,c,p;const r=S(($=s.modifiers)==null?void 0:$.width),i=S((P=s.modifiers)==null?void 0:P.height),a=we(s.sizes),n=(q=s.densities)!=null&&q.trim()?pe(s.densities.trim()):e.options.densities;ye(n);const o=r&&i?i/r:0,d=[],u=[];if(Object.keys(a).length>=1){for(const y in a){const _=U(y,String(a[y]),i,o,e);if(_!==void 0){d.push({size:_.size,screenMaxWidth:_.screenMaxWidth,media:`(max-width: ${_.screenMaxWidth}px)`});for(const l of n)u.push({width:_._cWidth*l,src:J(e,t,s,_,l)})}}Ie(d)}else for(const y of n){const _=Object.keys(a)[0];let l=_?U(_,String(a[_]),i,o,e):void 0;l===void 0&&(l={size:"",screenMaxWidth:0,_cWidth:(c=s.modifiers)==null?void 0:c.width,_cHeight:(p=s.modifiers)==null?void 0:p.height}),u.push({width:y,src:J(e,t,s,l,y)})}Ae(u);const m=u[u.length-1],g=d.length?d.map(y=>`${y.media?y.media+" ":""}${y.size}`).join(", "):void 0,v=g?"w":"x",I=u.map(y=>`${y.src} ${y.width}${v}`).join(", ");return{sizes:g,srcset:I,src:m==null?void 0:m.src}}function U(e,t,s,r,i){const a=i.options.screens&&i.options.screens[e]||Number.parseInt(e),n=t.endsWith("vw");if(!n&&/^\d+$/.test(t)&&(t=t+"px"),!n&&!t.endsWith("px"))return;let o=Number.parseInt(t);if(!a||!o)return;n&&(o=Math.round(o/100*a));const d=r?Math.round(o*r):s;return{size:t,screenMaxWidth:a,_cWidth:o,_cHeight:d}}function J(e,t,s,r,i){return e.$img(t,{...s.modifiers,width:r._cWidth?r._cWidth*i:void 0,height:r._cHeight?r._cHeight*i:void 0},s)}function Ie(e){var s;e.sort((r,i)=>r.screenMaxWidth-i.screenMaxWidth);let t=null;for(let r=e.length-1;r>=0;r--){const i=e[r];i.media===t&&e.splice(r,1),t=i.media}for(let r=0;r<e.length;r++)e[r].media=((s=e[r+1])==null?void 0:s.media)||""}function Ae(e){e.sort((s,r)=>s.width-r.width);let t=null;for(let s=e.length-1;s>=0;s--){const r=e[s];r.width===t&&e.splice(s,1),t=r.width}}const qe=ve({keyMap:{format:"f",fit:"fit",width:"w",height:"h",resize:"s",quality:"q",background:"b"},joinWith:"&",formatter:(e,t)=>O(e)+"_"+O(t)}),Pe=(e,{modifiers:t={},baseURL:s}={},r)=>{t.width&&t.height&&(t.resize=`${t.width}x${t.height}`,delete t.width,delete t.height);const i=qe(t)||"_";return s||(s=R(r.options.nuxt.baseURL,"/_ipx")),{url:R(s,i,ie(e))}},Ce=!0,Ee=!0,ze=Object.freeze(Object.defineProperty({__proto__:null,getImage:Pe,supportsAlias:Ee,validateDomains:Ce},Symbol.toStringTag,{value:"Module"})),K={screens:{xs:320,sm:640,md:768,lg:1024,xl:1280,xxl:1536,"2xl":1536},presets:{},provider:"ipx",domains:["bigfive.dev","secure.gravatar.com"],alias:{"/wordpress":"https://bigfive.dev/blogdinor"},densities:[1,2],format:["webp","jpg","png","webp"],quality:80};K.providers={ipx:{provider:ze,defaults:{}}};const ee=()=>{const e=Q(),t=G();return t.$img||t._img||(t._img=_e({...K,nuxt:{baseURL:e.app.baseURL},runtimeConfig:e}))};function Ne(e){var t;(t=performance==null?void 0:performance.mark)==null||t.call(performance,"mark_feature_usage",{detail:{feature:e}})}const je={src:{type:String,required:!1},format:{type:String,required:!1},quality:{type:[Number,String],required:!1},background:{type:String,required:!1},fit:{type:String,required:!1},modifiers:{type:Object,required:!1},preset:{type:String,required:!1},provider:{type:String,required:!1},sizes:{type:[Object,String],required:!1},densities:{type:String,required:!1},preload:{type:[Boolean,Object],required:!1},width:{type:[String,Number],required:!1},height:{type:[String,Number],required:!1},alt:{type:String,required:!1},referrerpolicy:{type:String,required:!1},usemap:{type:String,required:!1},longdesc:{type:String,required:!1},ismap:{type:Boolean,required:!1},loading:{type:String,required:!1,validator:e=>["lazy","eager"].includes(e)},crossorigin:{type:[Boolean,String],required:!1,validator:e=>["anonymous","use-credentials","",!0,!1].includes(e)},decoding:{type:String,required:!1,validator:e=>["async","auto","sync"].includes(e)},nonce:{type:[String],required:!1}},Me=e=>{const t=x(()=>({provider:e.provider,preset:e.preset})),s=x(()=>({width:S(e.width),height:S(e.height),alt:e.alt,referrerpolicy:e.referrerpolicy,usemap:e.usemap,longdesc:e.longdesc,ismap:e.ismap,crossorigin:e.crossorigin===!0?"anonymous":e.crossorigin||void 0,loading:e.loading,decoding:e.decoding,nonce:e.nonce})),r=ee(),i=x(()=>({...e.modifiers,width:S(e.width),height:S(e.height),format:e.format,quality:e.quality||r.options.quality,background:e.background,fit:e.fit}));return{options:t,attrs:s,modifiers:i}},Te={...je,placeholder:{type:[Boolean,String,Number,Array],required:!1},placeholderClass:{type:String,required:!1},custom:{type:Boolean,required:!1}},ke=["src"],Re=oe({__name:"NuxtImg",props:Te,emits:["load","error"],setup(e,{emit:t}){const s=e,r=ne(),i=t,a=!1,n=ee(),o=Me(s),d=b(!1),u=b(),m=x(()=>n.getSizes(s.src,{...o.options.value,sizes:s.sizes,densities:s.densities,modifiers:{...o.modifiers.value,width:S(s.width),height:S(s.height)}})),g=x(()=>{const c={...o.attrs.value,"data-nuxt-img":""};return(!s.placeholder||d.value)&&(c.sizes=m.value.sizes,c.srcset=m.value.srcset),c}),v=x(()=>{let c=s.placeholder;if(c===""&&(c=!0),!c||d.value)return!1;if(typeof c=="string")return c;const p=Array.isArray(c)?c:typeof c=="number"?[c,c]:[10,10];return n(s.src,{...o.modifiers.value,width:p[0],height:p[1],quality:p[2]||50,blur:p[3]||3},o.options.value)}),I=x(()=>s.sizes?m.value.src:n(s.src,o.modifiers.value,o.options.value)),$=x(()=>v.value?v.value:I.value),q=G().isHydrating;return ae(()=>{if(v.value||s.custom){const c=new Image;I.value&&(c.src=I.value),s.sizes&&(c.sizes=m.value.sizes||"",c.srcset=m.value.srcset),c.onload=p=>{d.value=!0,i("load",p)},c.onerror=p=>{i("error",p)},Ne("nuxt-image");return}u.value&&(u.value.complete&&q&&(u.value.getAttribute("data-error")?i("error",new Event("error")):i("load",new Event("load"))),u.value.onload=c=>{i("load",c)},u.value.onerror=c=>{i("error",c)})}),(c,p)=>c.custom?le(c.$slots,"default",ce(F({key:1},{...j(a)?{onerror:"this.setAttribute('data-error', 1)"}:{},imgAttrs:{...g.value,...j(r)},isLoaded:d.value,src:$.value}))):(Y(),X("img",F({key:0,ref_key:"imgEl",ref:u,class:v.value&&!d.value?c.placeholderClass:void 0},{...j(a)?{onerror:"this.setAttribute('data-error', 1)"}:{},...g.value,...j(r)},{src:$.value}),null,16,ke))}});function We(){const e=b([]),t=b([]),s=b(!0),r=b(null),i=b(1),a=b(6),n=b(null),o=x(()=>{const l=n.value?t.value.filter(h=>h.categories&&h.categories.some(f=>f.slug===n.value)):t.value;return Math.ceil(l.length/a.value)}),d=30,u=l=>{try{const h={data:l,expiry:Date.now()+d*60*1e3};localStorage.setItem("blogCache",JSON.stringify(h)),console.log("Cache sauvegardé avec",l.length,"articles")}catch(h){console.error("Erreur lors de la sauvegarde du cache:",h)}},m=()=>{try{const l=localStorage.getItem("blogCache");if(l){const{data:h,expiry:f}=JSON.parse(l);if(Date.now()<f)return console.log("Utilisation du cache avec",h.length,"articles"),h;console.log("Cache expiré, récupération de nouvelles données")}}catch(l){console.error("Erreur lors de la récupération du cache:",l)}return null},g=()=>{try{const l=n.value?t.value.filter(z=>z.categories&&z.categories.some(C=>C.slug===n.value)):t.value;console.log(`Filtrage des articles: ${l.length} articles après filtrage`);const h=(i.value-1)*a.value,f=h+a.value;e.value=l.slice(h,f),console.log(`Pagination: affichage des articles ${h} à ${f} (${e.value.length} articles)`),o.value>0&&i.value>o.value&&(i.value=o.value)}catch(l){console.error("Erreur lors de la mise à jour des posts paginés:",l)}},v=async(l=!1)=>{s.value=!0,r.value=null;try{console.log("------- DÉBUT RÉCUPÉRATION DES ARTICLES -------");const f=!l&&m();if(f)t.value=f,g();else{console.log("Pas de cache, récupération depuis l'API");const z=Q();console.log("Configuration détectée:",JSON.stringify(z.public));const C="";console.log("URL de base utilisée:",C),console.log("Requête API vers:",`${C}/api/articles`);const N=await fetch(`${C}/api/articles`);if(!N.ok)throw new Error(`Erreur HTTP: ${N.status} ${N.statusText}`);const A=await N.json();if(console.log("Réponse reçue:",A?`${A.length} articles reçus`:"Aucune donnée"),A&&Array.isArray(A))console.log("Premier article reçu:",A[0]?JSON.stringify(A[0].id):"Aucun article"),t.value=A.map(w=>{var W,D;let te=w.thumbnail||null;return console.log(`Article ID ${w.id} - Titre: ${w.title||"Sans titre"} - Thumbnail: ${te||"Aucun"}`),{id:w.id,title:w.title||"Sans titre",excerpt:((W=w.excerpt)==null?void 0:W.rendered)||w.excerpt||"",content:((D=w.content)==null?void 0:D.rendered)||w.content||"",date:w.date,slug:w.slug,thumbnail:w.thumbnail||null,categories:w.categories||[]}}),u(t.value),g();else throw new Error("Format de données invalide reçu de l'API")}}catch(f){console.error("Erreur lors de la récupération des posts :",f),r.value=f.message||"Erreur lors de la récupération des articles"}finally{console.log("------- FIN RÉCUPÉRATION DES ARTICLES -------"),s.value=!1}},I=async()=>v(!0),$=l=>t.value.find(h=>h.slug===l),P=async(l,h=!1)=>{try{(t.value.length===0||h)&&await v(h);const f=$(l);return f?(e.value=[f],f):(console.error(`Article avec slug '${l}' non trouvé`),e.value=[],null)}catch(f){return console.error(`Erreur lors de la récupération de l'article avec slug '${l}':`,f),r.value=`Impossible de charger l'article: ${f.message}`,e.value=[],null}},q=l=>{l>=1&&l<=o.value&&(i.value=l,g())},c=()=>{i.value<o.value&&(i.value++,g())},p=()=>{i.value>1&&(i.value--,g())},y=l=>{n.value=l,i.value=1,g()},_=()=>{n.value=null,i.value=1,g()};return ue([n,i],()=>{g()}),{posts:e,loading:s,error:r,fetchPosts:v,getPostBySlug:$,fetchPostBySlug:P,refreshCache:I,cache:t,currentPage:i,totalPages:o,itemsPerPage:a,goToPage:q,nextPage:c,prevPage:p,activeCategory:n,setActiveCategory:y,clearCategoryFilter:_}}const De={class:"site-header"},Be={class:"container"},Oe={class:"header-content"},Fe={class:"logo-wrapper"},He={class:"site-nav"},Le="Dinor App",Ue={__name:"Header",setup(e){const t=de(),{setActiveCategory:s,clearCategoryFilter:r}=We(),i=n=>{s(n),t.push({query:{category:n}})},a=()=>{r(),t.push("/")};return(n,o)=>{const d=Re,u=ge;return Y(),X("header",De,[M("div",Be,[M("div",Oe,[M("div",Fe,[E(u,{to:"/",class:"logo-link"},{default:T(()=>[E(d,{src:"/images/logo.jpg",alt:Le,width:"40",height:"40",class:"logo"})]),_:1})]),M("nav",He,[E(u,{to:"/",class:"nav-link","exact-active-class":"active",onClick:a},{default:T(()=>o[2]||(o[2]=[k(" Tous ")])),_:1}),E(u,{to:"/category/recette",class:"nav-link","active-class":"active",onClick:o[0]||(o[0]=H(m=>i("recette"),["prevent"]))},{default:T(()=>o[3]||(o[3]=[k(" Recettes ")])),_:1}),E(u,{to:"/category/top-10",class:"nav-link","active-class":"active",onClick:o[1]||(o[1]=H(m=>i("top-10"),["prevent"]))},{default:T(()=>o[4]||(o[4]=[k(" Top 10 ")])),_:1})])])])])}}},Qe=fe(Ue,[["__scopeId","data-v-d1e5869c"]]);export{Qe as H,Re as _,We as u};
